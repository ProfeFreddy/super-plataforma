import{R as e,u as Ye,r as c,c as Ke,o as Ze,h as H,d as h,e as d,i as O,n as B,q,m as we,L,l as F,p as et,O as Ae,s as Y,f as K,P as Z,M as ee,Q as Pe,S as ke}from"./index-BqLPJdMO.js";import{P as tt,C as at}from"./CronometroGlobal-CTnLldTF.js";import{_ as rt}from"./index-Ch80AtY6.js";import{P as nt}from"./planCaps-OxFxGX_F.js";function ot({palabras:n=[]}){return e.createElement("div",null,e.createElement("b",null,"Nube de Palabras:")," ",n.join(" Â· "))}var oe={};const st=tt||void 0||e.createContext({}),it=typeof process<"u"&&oe&&(oe.REACT_APP_PROXY_URL||oe.VITE_PROXY_BASE)||(typeof window<"u"?`${window.location.origin}/api`:"http://localhost:8080"),{auth:ct}=useAuthX?useAuthX():{auth:null};var Me;const se=(Me=ct||H)==null?void 0:Me.currentUser;se!=null&&se.displayName||perfil!=null&&perfil.nombre;const _e=(n="")=>n.toString().toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").trim(),lt={matematica:"matematica",matematicas:"matematica",lenguaje:"lenguaje","lenguaje y comunicacion":"lenguaje","lengua y literatura":"lenguaje",fisica:"fisica",quimica:"quimica",historia:"historia","historia y ciencias sociales":"historia",ingles:"ingles",biologia:"biologia",ciencias:"ciencias",tecnologia:"tecnologia"};function Ie(n=""){const s=_e(n);return lt[s]||"matematica"}function Re(n="",s=""){const y=_e(n||s);return/basico|b[aí]sico|b[aí]sica|basica/i.test(y)?"basica":"media"}function $e(){return new Date}function ut(){const n=$e().getDay();return n>=1&&n<=5?n-1:0}function dt(n=[]){const s=$e(),y=s.getHours()*60+s.getMinutes();for(let b=0;b<n.length-1;b++){const R=n[b][0]*60+n[b][1],X=n[b+1][0]*60+n[b+1][1];if(y>=R&&y<X)return b}return 0}function mt(n={}){if(Array.isArray(n.marcas)&&Array.isArray(n.marcas[0]))return n.marcas;if(Array.isArray(n.marcas)&&n.marcas.length&&typeof n.marcas[0]=="object")return n.marcas.map(s=>[Number(s.h)||0,Number(s.m)||0]);if(Array.isArray(n.marcasStr))return n.marcasStr.map(s=>{const[y,b]=String(s).split(":").map(R=>Number(R)||0);return[y,b]});if(Array.isArray(n.bloquesGenerados)&&n.bloquesGenerados.length){const s=n.bloquesGenerados.map(b=>String(b).split(" - ")[0]),y=String(n.bloquesGenerados.at(-1)).split(" - ")[1];return[...s,y].map(b=>{const[R,X]=b.split(":").map(ce=>Number(ce)||0);return[R,X]})}return[]}const p={brandA:"#2193b0",brandB:"#6dd5ed",white:"#ffffff",textDark:"#1f2937",textMuted:"#475569",border:"#e5e7eb",btnText:"#2193b0"},ft={minHeight:"100vh",background:`linear-gradient(to right, ${p.brandA}, ${p.brandB})`,padding:"2rem",fontFamily:"Segoe UI, sans-serif",color:p.white,boxSizing:"border-box"},pt=(n="1rem")=>({display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,2fr) minmax(0,1fr)",gap:n,alignItems:"stretch"}),k={background:p.white,color:p.textDark,borderRadius:12,padding:"1rem",boxShadow:"0 6px 18px rgba(16,24,40,.06), 0 2px 6px rgba(16,24,40,.03)",border:`1px solid ${p.border}`,maxWidth:"100%",overflow:"hidden",contain:"content",minWidth:0},M={willChange:"transform",transform:"translateZ(0)",backfaceVisibility:"hidden",WebkitFontSmoothing:"antialiased",textRendering:"optimizeLegibility"},I={background:p.white,color:p.btnText,border:"none",borderRadius:10,padding:".6rem .9rem",fontWeight:700,cursor:"pointer",boxShadow:"0 4px 10px rgba(0,0,0,.15)"},je={width:"100%",padding:"0.65rem 0.8rem",borderRadius:10,border:`1px solid ${p.border}`,fontSize:"0.95rem",outline:"none"},ie={color:p.textMuted,fontSize:12},gt=[{key:"pragma",name:"Carrera PRAGMA (en esta página)",desc:"Juego nativo de la plataforma. Publica rondas y muestra ranking.",type:"internal"},{key:"blooket",name:"Blooket",desc:"Lanza sets y comparte PIN con tu clase. Requiere tu cuenta.",type:"external",url:"https://dashboard.blooket.com/discover",premium:!0},{key:"decktoys",name:"Deck.Toys",desc:"Rutas y tableros interactivos. Requiere tu cuenta.",type:"external",url:"https://deck.toys/teacher",premium:!0},{key:"classcraft",name:"Classcraft",desc:"Gamificación del curso a largo plazo. Requiere tu cuenta.",type:"external",url:"https://game.classcraft.com",premium:!0}],yt="crono:cierre:v2";function Te(){try{const n=[];for(let s=0;s<localStorage.length;s++){const y=localStorage.key(s);y&&(y==="inicioClase_countdown_end"||y.startsWith("ic_countdown_end:")||y.startsWith("crono:"))&&n.push(y)}n.forEach(s=>localStorage.removeItem(s))}catch{}}const G=n=>/^\(sin/i.test(String(n||"")),bt=e.memo(function(){const[s,y]=c.useState(new Date().toLocaleTimeString());return c.useEffect(()=>{const b=setInterval(()=>y(new Date().toLocaleTimeString()),1e3);return()=>clearInterval(b)},[]),e.createElement("span",{className:"tnum clock-w"},s)}),ht=e.memo(function({unidad:s,objetivo:y,curso:b,asignatura:R}){return e.createElement("div",{style:{...k,textAlign:"center",...M}},e.createElement("div",{style:{fontWeight:800,fontSize:"1.2rem",marginBottom:6}},"Unidad"),e.createElement("div",{style:{marginBottom:6,...M}},e.createElement("strong",null,s||"(sin unidad)")),e.createElement("div",{style:{marginTop:4,color:p.textDark,...M}},e.createElement("strong",null,"Objetivo:")," ",y),e.createElement("div",{style:{marginTop:10,color:p.textMuted,...M}},e.createElement("strong",null,"Curso:")," ",b,"  |  ",e.createElement("strong",null,"Asignatura:")," ",R))},(n,s)=>n.unidad===s.unidad&&n.objetivo===s.objetivo&&n.curso===s.curso&&n.asignatura===s.asignatura),Et=e.memo(function({nombreProfesor:s,asignatura:y}){return e.createElement("div",{style:{...k,display:"flex",flexDirection:"column",gap:".6rem",...M}},e.createElement("div",{style:{display:"flex",gap:".5rem"}},e.createElement("button",{style:I},"🧑‍🏫"),e.createElement("button",{style:I},"🎓")),e.createElement("div",{style:{textAlign:"right"}},e.createElement("div",{style:{fontWeight:800,...M}},s),e.createElement("div",{style:{color:p.textMuted,...M}},y)))},(n,s)=>n.nombreProfesor===s.nombreProfesor&&n.asignatura===s.asignatura);function Pt({duracion:n=10}){const s=Ye(),y=c.useContext(st)||{},{user:b=null,plan:R="FREE",caps:X=nt.FREE,loading:ce=!1}=y,[vt,xt]=c.useState(""),[De,le]=c.useState("Profesor"),[A,N]=c.useState("(sin asignatura)"),[_,V]=c.useState("(sin curso)"),[$,U]=c.useState(""),[Be,ue]=c.useState(null),[z,D]=c.useState("(sin objetivo)");c.useEffect(()=>{},[]);const[E,Ne]=c.useState(null);c.useEffect(()=>{(async()=>{try{const t=await Ke(new Date);Ne(t),t!=null&&t.unidad&&!$&&U(t.unidad),t!=null&&t.asignatura&&A==="(sin asignatura)"&&N(t.asignatura),t!=null&&t.objetivo&&z==="(sin objetivo)"&&D(t.objetivo)}catch(t){console.error("[Cierre] getClaseVigente:",t)}})()},[]);const de=c.useRef(null);c.useEffect(()=>{A&&!G(A)&&(de.current=A)},[A]);const te=de.current||A,[S,ae]=c.useState(!1);c.useEffect(()=>{const t=Ze(H,async r=>{try{if(r)localStorage.setItem("uid",r.uid),ae(!0);else{const i=await et(H);localStorage.setItem("uid",i.user.uid),ae(!0)}}catch(i){console.error("[Cierre] auth error:",i),localStorage.getItem("uid")&&ae(!0)}});return()=>t()},[]);const[v,me]=c.useState(""),fe=c.useMemo(()=>{const t=window.location.origin.replace(/\/$/,"");return v?`${t}/participa?session=${encodeURIComponent(v)}`:`${t}/participa`},[v]),[l,pe]=c.useState(null),[ge,Ue]=c.useState([]),[re,ye]=c.useState(""),[ne,be]=c.useState(["","","",""]),[Q,he]=c.useState(0),[ze,Ee]=c.useState(!1),[We,ve]=c.useState(!1),[Oe,xe]=c.useState(0);c.useEffect(()=>{if(!S)return;(async()=>{var r,i,m;try{const a=localStorage.getItem("uid")||((r=H.currentUser)==null?void 0:r.uid);if(!a)return;const o=h(d,"usuarios",a),g=await O(o);g.exists()&&le(((i=g.data())==null?void 0:i.nombre)||"Profesor");const x=h(d,"profesores",a),w=await O(x);if(w.exists()){const u=w.data()||{},C=u.unidadInicial||"";if(U(f=>f||C),u.asignatura&&!G(u.asignatura)&&N(f=>G(f)?u.asignatura:f),V(f=>f==="(sin curso)"?u.curso||"(sin curso)":f),u.objetivo?D(u.objetivo):u.objetivoInicial&&D(u.objetivoInicial),C&&!Be)try{const f=Ie(u.asignatura||A||"Matemática"),P=Re(u.curso||_,(E==null?void 0:E.nivel)||""),J=`${it}/mineduc?asignatura=${encodeURIComponent(f)}&nivel=${encodeURIComponent(P)}&unidad=${encodeURIComponent(C)}`,W=await Ae.get(J),j=Array.isArray(W.data)?W.data[0]:null;if(j)ue(j);else throw new Error("Proxy sin resultados, intento directo")}catch{try{const P=Ie(u.asignatura||A||"Matemática"),J=Re(u.curso||_,(E==null?void 0:E.nivel)||""),W=`https://curriculumnacional.mineduc.cl/api/v1/oa/buscar?asignatura=${encodeURIComponent(P)}&nivel=${encodeURIComponent(J)}&unidad=${encodeURIComponent(C)}`,j=await Ae.get(W);ue(Array.isArray(j.data)?j.data[0]:null)}catch{}}}try{if(g.exists()){const u=((m=g.data())==null?void 0:m.horarioConfig)||{},C=mt(u);if(Array.isArray(C)&&C.length>1){const f=dt(C),P=ut(),J=`${f}-${P}`,W=h(d,"clases_detalle",a,"slots",J),j=await O(W);if(j.exists()){const T=j.data()||{};T.unidad&&!$&&U(T.unidad),T.objetivo&&z==="(sin objetivo)"&&D(T.objetivo),T.asignatura&&A==="(sin asignatura)"&&N(T.asignatura),T.curso&&_==="(sin curso)"&&V(T.curso)}}}}catch(u){console.warn("[Cierre] horarioConfig → clases_detalle:",(u==null?void 0:u.code)||(u==null?void 0:u.message))}try{const u=h(d,"clases_detalle",a,"slots","0-0"),C=await O(u);if(C.exists()){const f=C.data()||{};!$&&f.unidad&&U(f.unidad),z==="(sin objetivo)"&&f.objetivo&&D(f.objetivo),A==="(sin asignatura)"&&f.asignatura&&N(f.asignatura),_==="(sin curso)"&&f.curso&&V(f.curso)}}catch{}}catch(a){console.error("Error cargando datos de Cierre:",a)}})()},[S]),c.useEffect(()=>{S&&(async()=>{var t;try{const r=localStorage.getItem("uid")||((t=H.currentUser)==null?void 0:t.uid);if(!r)return;const i=h(d,"usuarios",r),m=await O(i);if(m.exists()){const a=m.data()||{};(!$||/^\(sin/i.test($))&&U(a.unidadInicial||a.unidad||""),A==="(sin asignatura)"&&a.asignatura&&N(a.asignatura),_==="(sin curso)"&&a.curso&&V(a.curso),z==="(sin objetivo)"&&a.objetivo&&D(a.objetivo)}}catch(r){console.warn("[Cierre] usuarios fallback:",(r==null?void 0:r.code)||(r==null?void 0:r.message))}})()},[S]),c.useEffect(()=>{var m;if(!S)return;const t=localStorage.getItem("uid")||((m=H.currentUser)==null?void 0:m.uid);if(!t)return;const r=a=>{a&&(a.nombre&&le(o=>a.nombre&&a.nombre!==o?a.nombre:o),U(o=>a.unidad&&a.unidad!==o?a.unidad:o),N(o=>a.asignatura&&!G(a.asignatura)&&a.asignatura!==o?a.asignatura:o),V(o=>a.curso&&!G(a.curso)&&a.curso!==o?a.curso:o),D(o=>a.objetivo&&!G(a.objetivo)&&a.objetivo!==o?a.objetivo:o))},i=[];try{const a=h(d,"clases_detalle",t,"meta","actual");i.push(B(a,o=>o.exists()&&r(o.data())))}catch{}try{const a=h(d,"clases_detalle",t,"actual","info");i.push(B(a,o=>o.exists()&&r(o.data())))}catch{}try{const a=h(d,"clases_detalle",t,"slots","0-0");i.push(B(a,o=>o.exists()&&r(o.data())))}catch{}try{const a=h(d,"profesores",t);i.push(B(a,o=>{var g,x,w,u,C,f,P;o.exists()&&r({nombre:(g=o.data())==null?void 0:g.nombre,unidad:((x=o.data())==null?void 0:x.unidad)||((w=o.data())==null?void 0:w.unidadInicial),objetivo:((u=o.data())==null?void 0:u.objetivo)||((C=o.data())==null?void 0:C.objetivoInicial),asignatura:(f=o.data())==null?void 0:f.asignatura,curso:(P=o.data())==null?void 0:P.curso})}))}catch{}return()=>i.forEach(a=>typeof a=="function"&&a())},[S]),c.useEffect(()=>{if(!S)return;(async()=>{var r;try{const i=h(d,"carrera","actual","meta","session"),m=await O(i);if(m.exists()&&((r=m.data())!=null&&r.id))me(String(m.data().id));else{const a=Math.random().toString(36).slice(2,8).toUpperCase();await Y(i,{id:a,createdAt:K()},{merge:!0}),me(a)}}catch(i){console.error("No se pudo crear/leer la sesión:",i)}})()},[S]),c.useEffect(()=>{if(!S)return;const t=h(d,"carrera","actual","meta","pregunta"),r=B(t,i=>{i.exists()?pe(i.data()):pe(null)});return()=>r()},[S]),c.useEffect(()=>{if(!S)return;let t;v?t=q(F(d,"carrera","actual","participantes"),L("session","==",v),we("progreso","desc")):t=q(F(d,"carrera","actual","participantes"),we("progreso","desc"));const r=B(t,i=>{const m=i.docs.map(a=>({id:a.id,...a.data()}));Ue(m)});return()=>r()},[v,S]),c.useEffect(()=>{if(!S||!(l!=null&&l.activa))return;let t;v?t=q(F(d,"carrera","actual","respuestas"),L("scored","!=",!0),L("session","==",v)):t=q(F(d,"carrera","actual","respuestas"),L("scored","!=",!0));const r=B(t,async i=>{var o;if(We)return;ve(!0);const m=[],a=(o=l==null?void 0:l.startAt)!=null&&o.toMillis?l.startAt.toMillis():null;i.docChanges().forEach(g=>{var x;if(g.type==="added"||g.type==="modified"){const w=g.doc.data();if(a&&((x=w.createdAt)!=null&&x.toMillis)&&w.createdAt.toMillis()<a||w.scored===!0)return;m.push({id:g.doc.id,data:w})}});for(const g of m)try{await Fe(g.id,g.data)}catch(x){console.error("Error scoring:",x)}ve(!1)});return()=>r()},[l==null?void 0:l.activa,l==null?void 0:l.startAt,Oe,v,S]);const qe=async()=>{if(!re.trim())return;const t=ne.map(r=>r.trim()).filter(r=>r.length>0);if(t.length>0&&(Q<0||Q>=t.length)){alert("Selecciona el índice de la respuesta correcta válido.");return}Ee(!0);try{await Y(h(d,"carrera","actual","meta","pregunta"),{texto:re.trim(),opciones:t.length>0?t:[],correcta:t.length>0?Q:null,startAt:K(),activa:!0,session:v||null},{merge:!0}),xe(r=>r+1)}catch(r){console.error(r),alert("No se pudo publicar la pregunta.")}finally{Ee(!1)}},Le=async()=>{try{await Z(h(d,"carrera","actual","meta","pregunta"),{activa:!1})}catch{}};async function Fe(t,r){const{pid:i,answer:m,latencyMs:a}=r;if(!i){await Z(h(d,"carrera","actual","respuestas",t),{scored:!0,points:0});return}let o=0;if(Array.isArray(l==null?void 0:l.opciones)&&l.opciones.length>0&&typeof(l==null?void 0:l.correcta)=="number"){const g=l.opciones[l.correcta];if(String(m).trim()===String(g).trim()){const w=typeof a=="number"?a/1e3:8;o=5+Math.max(0,8-Math.floor(w))}else o=0}else{const g=typeof a=="number"?a/1e3:8;o=2+Math.max(0,5-Math.floor(g))}try{await Z(h(d,"carrera","actual","participantes",i),{puntos:ke(o),progreso:ke(o)})}catch{await Y(h(d,"carrera","actual","participantes",i),{nombre:r.nombre||"Jugador",avatar:"🟢",progreso:o,puntos:o,joinedAt:K(),session:v||null},{merge:!0})}await Z(h(d,"carrera","actual","respuestas",t),{scored:!0,points:o})}const Se=c.useMemo(()=>[...ge].sort((t,r)=>(r.progreso||0)-(t.progreso||0)),[ge]),Ge=async()=>{if(window.confirm("¿Resetear carrera? Se borrarán participantes y respuestas, y se reiniciará la pregunta."))try{let r=F(d,"carrera","actual","participantes"),i=v?await ee(q(r,L("session","==",v))):await ee(r);const m=Pe(d);i.forEach(x=>m.delete(x.ref)),await m.commit();let a=F(d,"carrera","actual","respuestas"),o=v?await ee(q(a,L("session","==",v))):await ee(a);const g=Pe(d);o.forEach(x=>g.delete(x.ref)),await g.commit(),await Y(h(d,"carrera","actual","meta","pregunta"),{texto:"",opciones:[],correcta:null,activa:!1,startAt:K(),session:v||null},{merge:!0}),ye(""),be(["","","",""]),he(0),xe(x=>x+1),alert("Carrera reseteada ✅")}catch{alert("No se pudo resetear la carrera.")}},He=t=>{try{const r=new URL(t);r.searchParams.set("utm_source","pragma"),r.searchParams.set("utm_medium","launcher"),r.searchParams.set("utm_campaign","cierre");const i=localStorage.getItem("salaCode")||"";i&&r.searchParams.set("code",i),window.open(r.toString(),"_blank","noopener,noreferrer")}catch{window.open(t,"_blank","noopener,noreferrer")}},Ve=()=>{try{const t=document.getElementById("carreraPanel");t!=null&&t.scrollIntoView&&t.scrollIntoView({behavior:"smooth",block:"start"})}catch{}},Je={duracion:n,storageKey:yt,instanceId:"cierre"};function Ce(){try{const t={unidad:$||"",objetivo:z||"",asignatura:te||"",curso:_||"",ts:Date.now(),from:"cierre"};localStorage.setItem("bridge:desarrolloClase",JSON.stringify(t))}catch{}}function Xe(){Ce(),s("/desarrollo")}function Qe(){try{Ce()}catch{}Te(),s("/inicio",{replace:!0,state:{resetTimers:!0,from:"cierre",autoReturn:!0}})}return e.createElement("div",{style:ft,className:"no-scroll-jump"},E&&e.createElement("div",{style:{...k,marginBottom:"1rem",background:E.fuente==="calendario"?"rgba(124,58,237,.06)":"rgba(2,132,199,.06)"}},e.createElement("div",{style:{fontWeight:800}},E.fuente==="calendario"?"Plan semanal (vigente)":E.fuente==="slots"?"Horario (fallback)":"Sin clase planificada"),E.unidad&&e.createElement("div",null,e.createElement("b",null,"Unidad:")," ",E.unidad,E.evaluacion?" · (Evaluación)":""),(E==null?void 0:E.objetivo)&&e.createElement("div",null,e.createElement("b",null,"Objetivo:")," ",E.objetivo)),e.createElement("div",{style:{...pt("1rem"),marginBottom:"1rem"}},e.createElement("div",{style:{...k,...M},className:"no-scroll-jump layer-accel"},e.createElement("div",{style:{fontWeight:800,fontSize:"1.1rem",marginBottom:6}},"Cierre"),e.createElement("div",{style:{color:p.textMuted,marginBottom:8}},"⏰ ",e.createElement(bt,null)),e.createElement("div",{className:"tnum clock-w layer-accel",style:{fontVariantNumeric:"tabular-nums lining-nums",fontFeatureSettings:"'tnum' 1, 'lnum' 1",transform:"translateZ(0)",willChange:"transform",backfaceVisibility:"hidden"}},e.createElement(at,{...Je,onEnd:Qe}))),e.createElement(ht,{unidad:$,objetivo:z,curso:_,asignatura:te}),e.createElement(Et,{nombreProfesor:De,asignatura:te})),e.createElement("div",{style:{...k,textAlign:"center",marginBottom:"1rem"}},e.createElement("h3",{style:{marginTop:0}},"🧠 Nube de palabras final"),e.createElement(ot,{modo:"cierre"})),e.createElement("div",{style:{...k,textAlign:"center",marginBottom:"1rem"}},e.createElement("h3",{style:{marginTop:0}},"🔗 Únete a la carrera"),e.createElement("div",{style:{display:"flex",gap:16,justifyContent:"center",alignItems:"center",flexWrap:"wrap"}},e.createElement("div",{style:{background:"#fff",padding:12,borderRadius:8,border:`1px solid ${p.border}`}},e.createElement(rt,{value:fe,size:160})),e.createElement("div",null,e.createElement("div",{style:{fontWeight:800,fontSize:18}},"Sesión: ",v||"—"),e.createElement("div",{style:{color:p.textMuted,fontSize:14,marginTop:6}},"Abre ",e.createElement("code",null,"/participa")," o escanea el QR. Link directo:"),e.createElement("code",{style:{fontSize:12,color:p.textMuted}},fe)))),e.createElement("div",{style:{...k,marginBottom:"1rem"}},e.createElement("h3",{style:{marginTop:0,marginBottom:8}},"🎮 Centro de Juegos"),e.createElement("div",{style:{color:p.textMuted,fontSize:13,marginBottom:8}},"Los juegos externos se abren en pestaña nueva y requieren tu propia cuenta."),e.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))",gap:10}},gt.map(t=>e.createElement("div",{key:t.key,style:{border:`1px solid ${p.border}`,borderRadius:10,padding:12}},e.createElement("div",{style:{fontWeight:800}},t.name," ",t.premium?e.createElement("span",{style:{fontSize:12,color:"#9333ea"}},"· Premium"):null),e.createElement("div",{style:{color:p.textMuted,fontSize:14,marginTop:4}},t.desc),e.createElement("div",{style:{display:"flex",gap:8,marginTop:10,flexWrap:"wrap"}},t.type==="internal"?e.createElement("button",{style:I,onClick:Ve},"🏁 Ir a Carrera"):e.createElement(e.Fragment,null,e.createElement("button",{style:I,onClick:()=>He(t.url)},"🔗 Abrir"))))))),e.createElement("div",{id:"carreraPanel",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"}},e.createElement("div",{style:k},e.createElement("h3",{style:{marginTop:0}},"🎮 Mini panel del profesor"),e.createElement("div",{style:{...ie,marginBottom:8}},"Publica una pregunta (texto + 0–4 opciones). Si agregas opciones, selecciona cuál es la correcta."),e.createElement("label",{style:{fontWeight:700}},"Pregunta"),e.createElement("input",{style:{...je,marginBottom:8},value:re,onChange:t=>ye(t.target.value),placeholder:"Escribe la pregunta…"}),e.createElement("label",{style:{fontWeight:700}},"Opciones (opcional)"),ne.map((t,r)=>e.createElement("div",{key:r,style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:8,alignItems:"center",marginBottom:6}},e.createElement("input",{type:"radio",name:"correcta",checked:Q===r,onChange:()=>he(r),title:"Marcar correcta"}),e.createElement("input",{style:je,value:t,onChange:i=>{const m=[...ne];m[r]=i.target.value,be(m)},placeholder:`Opción ${r+1}`}))),e.createElement("div",{style:{display:"flex",gap:8,marginTop:8}},e.createElement("button",{style:I,onClick:qe,disabled:ze,title:"Publicar pregunta"},"🚀 Publicar ronda"),e.createElement("button",{style:I,onClick:Le,title:"Cerrar ronda"},"⛔ Cerrar ronda")),e.createElement("div",{style:{...ie,marginTop:8}},l!=null&&l.activa?"Ronda ACTIVA":"Ronda INACTIVA"," ",l!=null&&l.texto?`• "${l.texto}"`:"")),e.createElement("div",{style:k},e.createElement("h3",{style:{marginTop:0}},"🏁 Carrera en vivo"),e.createElement("div",{style:{...ie,marginBottom:8}},"Avance = acierto (5 pts) + bonus por rapidez (hasta +8). Participación abierta: pequeño avance."),e.createElement("div",{style:{display:"grid",gap:10}},Se.length===0&&e.createElement("div",{style:{color:p.textMuted}},"Aún no hay participantes. Pide a tus estudiantes abrir ",e.createElement("code",null,"/participa"),"."),Se.map(t=>{const r=Math.min(100,Math.round(t.progreso||0));return e.createElement("div",{key:t.id,style:{display:"grid",gridTemplateColumns:"40px 1fr 60px",gap:8,alignItems:"center"}},e.createElement("div",{style:{textAlign:"center",fontSize:20}},t.avatar||"🟢"),e.createElement("div",{style:{background:"#eef2f7",borderRadius:999,overflow:"hidden",border:`1px solid ${p.border}`}},e.createElement("div",{style:{width:`${r}%`,background:`linear-gradient(90deg, ${p.brandA}, ${p.brandB})`,color:"#fff",padding:"6px 10px",whiteSpace:"nowrap",textOverflow:"ellipsis"},title:`${t.nombre} (${r} pts)`},e.createElement("strong",{style:{fontSize:12}},t.nombre||"Jugador"))),e.createElement("div",{style:{textAlign:"right",fontWeight:800}},t.progreso||0))})))),e.createElement("div",{style:{textAlign:"center",display:"flex",gap:8,justifyContent:"center",flexWrap:"wrap"}},e.createElement("button",{onClick:Ge,style:I,title:"Borrar participantes, respuestas y reiniciar pregunta"},"🧹 Reset carrera"),e.createElement("button",{onClick:Xe,style:I,title:"Ir a Desarrollo (guarda la clase actual y navega)"},"➡️ Ir a Desarrollo"),e.createElement("button",{onClick:()=>{Te(),s("/InicioClase",{replace:!0,state:{resetTimers:!0,from:"cierre"}})},style:I},"⬅️ Volver al Inicio")))}export{Pt as default};
